@preconcurrency import BigInt
@preconcurrency import Eth
import Foundation

public enum AcrossActions {
    public struct DepositV3Params: Equatable {
        public static let schema: ABI.Schema = .tuple([.address, .address, .address, .address, .uint256, .uint256, .uint256, .uint256, .address, .uint32, .uint32, .uint32, .bytes])

        public let depositor: EthAddress
        public let recipient: EthAddress
        public let inputToken: EthAddress
        public let outputToken: EthAddress
        public let inputAmount: BigUInt
        public let outputAmount: BigUInt
        public let maxFee: BigUInt
        public let destinationChainId: BigUInt
        public let exclusiveRelayer: EthAddress
        public let quoteTimestamp: UInt
        public let fillDeadline: UInt
        public let exclusivityDeadline: UInt
        public let message: Hex

        public init(depositor: EthAddress, recipient: EthAddress, inputToken: EthAddress, outputToken: EthAddress, inputAmount: BigUInt, outputAmount: BigUInt, maxFee: BigUInt, destinationChainId: BigUInt, exclusiveRelayer: EthAddress, quoteTimestamp: UInt, fillDeadline: UInt, exclusivityDeadline: UInt, message: Hex) {
            self.depositor = depositor
            self.recipient = recipient
            self.inputToken = inputToken
            self.outputToken = outputToken
            self.inputAmount = inputAmount
            self.outputAmount = outputAmount
            self.maxFee = maxFee
            self.destinationChainId = destinationChainId
            self.exclusiveRelayer = exclusiveRelayer
            self.quoteTimestamp = quoteTimestamp
            self.fillDeadline = fillDeadline
            self.exclusivityDeadline = exclusivityDeadline
            self.message = message
        }

        public var encoded: Hex {
            asValue.encoded
        }

        public var asValue: ABI.Value {
            .tuple13(.address(depositor),
                     .address(recipient),
                     .address(inputToken),
                     .address(outputToken),
                     .uint256(inputAmount),
                     .uint256(outputAmount),
                     .uint256(maxFee),
                     .uint256(destinationChainId),
                     .address(exclusiveRelayer),
                     .uint32(quoteTimestamp),
                     .uint32(fillDeadline),
                     .uint32(exclusivityDeadline),
                     .bytes(message))
        }

        public static func decode(hex: Hex) throws -> DepositV3Params {
            if let value = try? schema.decode(hex) {
                return try decodeValue(value)
            }
            // both versions are valid encodings of tuples with dynamic fields ( bytes or string ), so try both decodings
            if case let .tuple1(wrappedValue) = try? ABI.Schema.tuple([schema]).decode(hex) {
                return try decodeValue(wrappedValue)
            }
            // retry original to throw the error
            return try decodeValue(schema.decode(hex))
        }

        public static func decodeValue(_ value: ABI.Value) throws -> DepositV3Params {
            switch value {
            case let .tuple13(.address(depositor),
                              .address(recipient),
                              .address(inputToken),
                              .address(outputToken),
                              .uint256(inputAmount),
                              .uint256(outputAmount),
                              .uint256(maxFee),
                              .uint256(destinationChainId),
                              .address(exclusiveRelayer),
                              .uint32(quoteTimestamp),
                              .uint32(fillDeadline),
                              .uint32(exclusivityDeadline),
                              .bytes(message)):
                return DepositV3Params(depositor: depositor, recipient: recipient, inputToken: inputToken, outputToken: outputToken, inputAmount: inputAmount, outputAmount: outputAmount, maxFee: maxFee, destinationChainId: destinationChainId, exclusiveRelayer: exclusiveRelayer, quoteTimestamp: quoteTimestamp, fillDeadline: fillDeadline, exclusivityDeadline: exclusivityDeadline, message: message)
            default:
                throw ABI.DecodeError.mismatchedType(value.schema, schema)
            }
        }
    }

    public static let creationCode: Hex = "0x608060405234601c57600e6020565b61121a61002b823961121a90f35b6026565b60405190565b5f80fdfe60806040526004361015610013575b61042b565b61001d5f3561002c565b63059fd7180361000e576103fe565b60e01c90565b60405190565b5f80fd5b5f80fd5b73ffffffffffffffffffffffffffffffffffffffff1690565b61006290610040565b90565b61006e81610059565b0361007557565b5f80fd5b9050359061008682610065565b565b5f80fd5b601f801991011690565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b906100cd9061008c565b810190811067ffffffffffffffff8211176100e757604052565b610096565b906100ff6100f8610032565b92836100c3565b565b5f80fd5b90565b61011181610105565b0361011857565b5f80fd5b9050359061012982610108565b565b63ffffffff1690565b61013d8161012b565b0361014457565b5f80fd5b9050359061015582610134565b565b5f80fd5b5f80fd5b67ffffffffffffffff811161017d5761017960209161008c565b0190565b610096565b90825f939282370152565b909291926101a261019d8261015f565b6100ec565b938185526020850190828401116101be576101bc92610182565b565b61015b565b9080601f830112156101e1578160206101de9335910161018d565b90565b610157565b9190916101a08184031261030a576101ff6101a06100ec565b9261020c815f8401610079565b5f85015261021d8160208401610079565b602085015261022f8160408401610079565b60408501526102418160608401610079565b6060850152610253816080840161011c565b60808501526102658160a0840161011c565b60a08501526102778160c0840161011c565b60c08501526102898160e0840161011c565b60e085015261029c816101008401610079565b6101008501526102b0816101208401610148565b6101208501526102c4816101408401610148565b6101408501526102d8816101608401610148565b61016085015261018082013567ffffffffffffffff8111610305576102fd92016101c3565b610180830152565b610101565b610088565b5f80fd5b5f80fd5b909182601f830112156103515781359167ffffffffffffffff831161034c57602001926001830284011161034757565b610313565b61030f565b610157565b151590565b61036481610356565b0361036b57565b5f80fd5b9050359061037c8261035b565b565b9190916080818403126103f457610397835f8301610079565b92602082013567ffffffffffffffff81116103ef57816103b89184016101e6565b92604083013567ffffffffffffffff81116103ea576103dc836103e7928601610317565b93909460600161036f565b90565b61003c565b61003c565b610038565b5f0190565b61041561040c36600461037e565b9392909261083f565b61041d610032565b80610427816103f9565b0390f35b5f80fd5b6104399051610105565b90565b6104469051610059565b90565b90565b61046061045b61046592610040565b610449565b610040565b90565b6104719061044c565b90565b61047d90610468565b90565b6104899061044c565b90565b61049590610480565b90565b6104a190610480565b90565b60e01b90565b905051906104b782610108565b565b906020828203126104d2576104cf915f016104aa565b90565b610038565b6104e090610059565b9052565b91906104f7905f602085019401906104d7565b565b610501610032565b3d5f823e3d90fd5b9061051390610105565b9052565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b61055361055991939293610105565b92610105565b820391821161056457565b610517565b61057290610105565b9052565b91602061059792949361059060408201965f830190610569565b0190610569565b565b6105a3905161012b565b90565b6105af9061012b565b9052565b5190565b60209181520190565b90825f9392825e0152565b6105ea6105f36020936105f8936105e1816105b3565b938480936105b7565b958691016105c0565b61008c565b0190565b99979593919a98969492909a6101808b019b5f8c0161061a916104d7565b60208b01610627916104d7565b60408a01610634916104d7565b60608901610641916104d7565b6080880161064e91610569565b60a0870161065b91610569565b60c0860161066891610569565b60e08501610675916104d7565b6101008401610683916105a6565b6101208301610691916105a6565b610140820161069f916105a6565b8082039061016001526106b1916105cb565b90565b67ffffffffffffffff81116106d2576106ce60209161008c565b0190565b610096565b906106e96106e4836106b4565b6100ec565b918252565b5f7f1dc0de0000000000000000000000000000000000000000000000000000000000910152565b61071f60036106d7565b9061072c602083016106ee565b565b610736610715565b90565b61074161072e565b90565b905090565b61076e6107659260209261075c816105b3565b94858093610744565b938491016105c0565b0190565b9091826107828161078993610744565b8093610182565b0190565b9161079f6107ab95936107a593610749565b90610749565b91610772565b90565b6107cd6107d99395946107bf610032565b96879460208601948561078d565b908103825203836100c3565b565b90565b6107f26107ed6107f7926107db565b610449565b610105565b90565b9061080c6108078361015f565b6100ec565b918252565b606090565b3d5f14610831576108263d6107fa565b903d5f602084013e5b565b610839610811565b9061082f565b93919290926108506080850161042f565b61088261087c7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff610105565b91610105565b14610a99575b6108b261089f61089a6040870161043c565b610474565b866108ac6080880161042f565b91610bf9565b6108d36108c16080860161042f565b6108cd60a0870161042f565b90610544565b806108f16108eb6108e660c0890161042f565b610105565b91610105565b11610a5557507f7b93923200000000000000000000000000000000000000000000000000000000845f016109249061043c565b90856020016109329061043c565b91866040016109409061043c565b878060600161094e9061043c565b8160800161095b9061042f565b8260a0016109689061042f565b8360e0016109759061042f565b84610100016109839061043c565b91856101200161099290610599565b9386610140016109a190610599565b9587610160016109b090610599565b976101800151986109bf610032565b9c8d9c60208e019081526004019b6109d69c6105fc565b6020820181038252036109e990826100c3565b916109f2610739565b9190916109fe936107ae565b92905f14925f93928493610a45576080610a18910161042f565b915b91602082019151925af1610a36610a2f610816565b9115610356565b610a3d5750565b602081519101fd5b50610a4f836107de565b91610a1a565b610a6160c0860161042f565b90610a955f9283927f1d1e0dd900000000000000000000000000000000000000000000000000000000845260048401610576565b0390fd5b610aec6020610aba610ab5610ab06040890161043c565b610474565b61048c565b6370a0823190610ae1610acc30610498565b92610ad5610032565b958694859384936104a4565b8352600483016104e4565b03915afa8015610b3e57610b0b915f91610b10575b5060808601610509565b610888565b610b31915060203d8111610b37575b610b2981836100c3565b8101906104b9565b5f610b01565b503d610b1f565b6104f9565b7fffffffff000000000000000000000000000000000000000000000000000000001690565b610b7c610b77610b819261012b565b6104a4565b610b43565b90565b916020610ba5929493610b9e60408201965f8301906104d7565b0190610569565b565b60ff1690565b610bc1610bbc610bc6926107db565b610449565b610ba7565b90565b610bd290610bad565b9052565b916020610bf7929493610bf060408201965f8301906104d7565b0190610bc9565b565b9091610c3a600491610c2b610c1163095ea7b3610b68565b9186610c1b610032565b9586946020860190815201610b84565b602082018103825203826100c3565b90610c4f610c49828490610ce4565b15610356565b610c59575b505050565b610ca66004610cab94610ca18491610c92610c7763095ea7b3610b68565b915f90610c82610032565b9687946020860190815201610bd6565b602082018103825203836100c3565b610e9c565b610e9c565b5f8080610c54565b5f90565b90505190610cc48261035b565b565b90602082820312610cdf57610cdc915f01610cb7565b90565b610038565b905f8091610cf0610cb3565b50610cfa8461048c565b9082602082019151925af1610d0d610816565b81610d38575b509081610d1f575b5090565b610d329150610d2d9061048c565b610f08565b5f610d1b565b9050610d43816105b3565b610d55610d4f5f6107de565b91610105565b14908115610d65575b505f610d13565b610d8091506020610d75826105b3565b818301019101610cc6565b5f610d5e565b5f7f5361666545524332303a206c6f772d6c6576656c2063616c6c206661696c6564910152565b610db760206106d7565b90610dc460208301610d86565b565b610dce610dad565b90565b60209181520190565b60207f6f74207375636365656400000000000000000000000000000000000000000000917f5361666545524332303a204552433230206f7065726174696f6e20646964206e5f8201520152565b610e34602a604092610dd1565b610e3d81610dda565b0190565b610e569060208101905f818303910152610e27565b90565b15610e6057565b610e68610032565b7f08c379a000000000000000000000000000000000000000000000000000000000815280610e9860048201610e41565b0390fd5b610ee591610eac610ebb9261048c565b90610eb5610dc6565b91610f28565b610ec4816105b3565b610ed6610ed05f6107de565b91610105565b14908115610ee7575b50610e59565b565b610f0291506020610ef7826105b3565b818301019101610cc6565b5f610edf565b610f10610cb3565b503b610f24610f1e5f6107de565b91610105565b1190565b90610f479291610f36610811565b5090610f415f6107de565b91611018565b90565b610f5390610480565b90565b60207f722063616c6c0000000000000000000000000000000000000000000000000000917f416464726573733a20696e73756666696369656e742062616c616e636520666f5f8201520152565b610fb06026604092610dd1565b610fb981610f56565b0190565b610fd29060208101905f818303910152610fa3565b90565b15610fdc57565b610fe4610032565b7f08c379a00000000000000000000000000000000000000000000000000000000081528061101460048201610fbd565b0390fd5b915f809161106e9593611029610811565b5061105061103630610f4a565b3161104961104385610105565b91610105565b1015610fd5565b8591602082019151925af191611064610816565b909290919261110d565b90565b5f7f416464726573733a2063616c6c20746f206e6f6e2d636f6e7472616374000000910152565b6110a5601d602092610dd1565b6110ae81611071565b0190565b6110c79060208101905f818303910152611098565b90565b156110d157565b6110d9610032565b7f08c379a000000000000000000000000000000000000000000000000000000000815280611109600482016110b2565b0390fd5b919290611118610811565b505f1461115c5750611129826105b3565b61113b6111355f6107de565b91610105565b14611145575b5090565b61115161115691610f08565b6110ca565b5f611141565b826111af565b5190565b61118561118e6020936111939361117c81611162565b93848093610dd1565b958691016105c0565b61008c565b0190565b6111ac9160208201915f818403910152611166565b90565b906111b9826105b3565b6111cb6111c55f6107de565b91610105565b115f146111db5750805190602001fd5b611216906111e7610032565b9182917f08c379a000000000000000000000000000000000000000000000000000000000835260048301611197565b0390fd"
    public static let runtimeCode: Hex = "0x60806040526004361015610013575b61042b565b61001d5f3561002c565b63059fd7180361000e576103fe565b60e01c90565b60405190565b5f80fd5b5f80fd5b73ffffffffffffffffffffffffffffffffffffffff1690565b61006290610040565b90565b61006e81610059565b0361007557565b5f80fd5b9050359061008682610065565b565b5f80fd5b601f801991011690565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b906100cd9061008c565b810190811067ffffffffffffffff8211176100e757604052565b610096565b906100ff6100f8610032565b92836100c3565b565b5f80fd5b90565b61011181610105565b0361011857565b5f80fd5b9050359061012982610108565b565b63ffffffff1690565b61013d8161012b565b0361014457565b5f80fd5b9050359061015582610134565b565b5f80fd5b5f80fd5b67ffffffffffffffff811161017d5761017960209161008c565b0190565b610096565b90825f939282370152565b909291926101a261019d8261015f565b6100ec565b938185526020850190828401116101be576101bc92610182565b565b61015b565b9080601f830112156101e1578160206101de9335910161018d565b90565b610157565b9190916101a08184031261030a576101ff6101a06100ec565b9261020c815f8401610079565b5f85015261021d8160208401610079565b602085015261022f8160408401610079565b60408501526102418160608401610079565b6060850152610253816080840161011c565b60808501526102658160a0840161011c565b60a08501526102778160c0840161011c565b60c08501526102898160e0840161011c565b60e085015261029c816101008401610079565b6101008501526102b0816101208401610148565b6101208501526102c4816101408401610148565b6101408501526102d8816101608401610148565b61016085015261018082013567ffffffffffffffff8111610305576102fd92016101c3565b610180830152565b610101565b610088565b5f80fd5b5f80fd5b909182601f830112156103515781359167ffffffffffffffff831161034c57602001926001830284011161034757565b610313565b61030f565b610157565b151590565b61036481610356565b0361036b57565b5f80fd5b9050359061037c8261035b565b565b9190916080818403126103f457610397835f8301610079565b92602082013567ffffffffffffffff81116103ef57816103b89184016101e6565b92604083013567ffffffffffffffff81116103ea576103dc836103e7928601610317565b93909460600161036f565b90565b61003c565b61003c565b610038565b5f0190565b61041561040c36600461037e565b9392909261083f565b61041d610032565b80610427816103f9565b0390f35b5f80fd5b6104399051610105565b90565b6104469051610059565b90565b90565b61046061045b61046592610040565b610449565b610040565b90565b6104719061044c565b90565b61047d90610468565b90565b6104899061044c565b90565b61049590610480565b90565b6104a190610480565b90565b60e01b90565b905051906104b782610108565b565b906020828203126104d2576104cf915f016104aa565b90565b610038565b6104e090610059565b9052565b91906104f7905f602085019401906104d7565b565b610501610032565b3d5f823e3d90fd5b9061051390610105565b9052565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b61055361055991939293610105565b92610105565b820391821161056457565b610517565b61057290610105565b9052565b91602061059792949361059060408201965f830190610569565b0190610569565b565b6105a3905161012b565b90565b6105af9061012b565b9052565b5190565b60209181520190565b90825f9392825e0152565b6105ea6105f36020936105f8936105e1816105b3565b938480936105b7565b958691016105c0565b61008c565b0190565b99979593919a98969492909a6101808b019b5f8c0161061a916104d7565b60208b01610627916104d7565b60408a01610634916104d7565b60608901610641916104d7565b6080880161064e91610569565b60a0870161065b91610569565b60c0860161066891610569565b60e08501610675916104d7565b6101008401610683916105a6565b6101208301610691916105a6565b610140820161069f916105a6565b8082039061016001526106b1916105cb565b90565b67ffffffffffffffff81116106d2576106ce60209161008c565b0190565b610096565b906106e96106e4836106b4565b6100ec565b918252565b5f7f1dc0de0000000000000000000000000000000000000000000000000000000000910152565b61071f60036106d7565b9061072c602083016106ee565b565b610736610715565b90565b61074161072e565b90565b905090565b61076e6107659260209261075c816105b3565b94858093610744565b938491016105c0565b0190565b9091826107828161078993610744565b8093610182565b0190565b9161079f6107ab95936107a593610749565b90610749565b91610772565b90565b6107cd6107d99395946107bf610032565b96879460208601948561078d565b908103825203836100c3565b565b90565b6107f26107ed6107f7926107db565b610449565b610105565b90565b9061080c6108078361015f565b6100ec565b918252565b606090565b3d5f14610831576108263d6107fa565b903d5f602084013e5b565b610839610811565b9061082f565b93919290926108506080850161042f565b61088261087c7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff610105565b91610105565b14610a99575b6108b261089f61089a6040870161043c565b610474565b866108ac6080880161042f565b91610bf9565b6108d36108c16080860161042f565b6108cd60a0870161042f565b90610544565b806108f16108eb6108e660c0890161042f565b610105565b91610105565b11610a5557507f7b93923200000000000000000000000000000000000000000000000000000000845f016109249061043c565b90856020016109329061043c565b91866040016109409061043c565b878060600161094e9061043c565b8160800161095b9061042f565b8260a0016109689061042f565b8360e0016109759061042f565b84610100016109839061043c565b91856101200161099290610599565b9386610140016109a190610599565b9587610160016109b090610599565b976101800151986109bf610032565b9c8d9c60208e019081526004019b6109d69c6105fc565b6020820181038252036109e990826100c3565b916109f2610739565b9190916109fe936107ae565b92905f14925f93928493610a45576080610a18910161042f565b915b91602082019151925af1610a36610a2f610816565b9115610356565b610a3d5750565b602081519101fd5b50610a4f836107de565b91610a1a565b610a6160c0860161042f565b90610a955f9283927f1d1e0dd900000000000000000000000000000000000000000000000000000000845260048401610576565b0390fd5b610aec6020610aba610ab5610ab06040890161043c565b610474565b61048c565b6370a0823190610ae1610acc30610498565b92610ad5610032565b958694859384936104a4565b8352600483016104e4565b03915afa8015610b3e57610b0b915f91610b10575b5060808601610509565b610888565b610b31915060203d8111610b37575b610b2981836100c3565b8101906104b9565b5f610b01565b503d610b1f565b6104f9565b7fffffffff000000000000000000000000000000000000000000000000000000001690565b610b7c610b77610b819261012b565b6104a4565b610b43565b90565b916020610ba5929493610b9e60408201965f8301906104d7565b0190610569565b565b60ff1690565b610bc1610bbc610bc6926107db565b610449565b610ba7565b90565b610bd290610bad565b9052565b916020610bf7929493610bf060408201965f8301906104d7565b0190610bc9565b565b9091610c3a600491610c2b610c1163095ea7b3610b68565b9186610c1b610032565b9586946020860190815201610b84565b602082018103825203826100c3565b90610c4f610c49828490610ce4565b15610356565b610c59575b505050565b610ca66004610cab94610ca18491610c92610c7763095ea7b3610b68565b915f90610c82610032565b9687946020860190815201610bd6565b602082018103825203836100c3565b610e9c565b610e9c565b5f8080610c54565b5f90565b90505190610cc48261035b565b565b90602082820312610cdf57610cdc915f01610cb7565b90565b610038565b905f8091610cf0610cb3565b50610cfa8461048c565b9082602082019151925af1610d0d610816565b81610d38575b509081610d1f575b5090565b610d329150610d2d9061048c565b610f08565b5f610d1b565b9050610d43816105b3565b610d55610d4f5f6107de565b91610105565b14908115610d65575b505f610d13565b610d8091506020610d75826105b3565b818301019101610cc6565b5f610d5e565b5f7f5361666545524332303a206c6f772d6c6576656c2063616c6c206661696c6564910152565b610db760206106d7565b90610dc460208301610d86565b565b610dce610dad565b90565b60209181520190565b60207f6f74207375636365656400000000000000000000000000000000000000000000917f5361666545524332303a204552433230206f7065726174696f6e20646964206e5f8201520152565b610e34602a604092610dd1565b610e3d81610dda565b0190565b610e569060208101905f818303910152610e27565b90565b15610e6057565b610e68610032565b7f08c379a000000000000000000000000000000000000000000000000000000000815280610e9860048201610e41565b0390fd5b610ee591610eac610ebb9261048c565b90610eb5610dc6565b91610f28565b610ec4816105b3565b610ed6610ed05f6107de565b91610105565b14908115610ee7575b50610e59565b565b610f0291506020610ef7826105b3565b818301019101610cc6565b5f610edf565b610f10610cb3565b503b610f24610f1e5f6107de565b91610105565b1190565b90610f479291610f36610811565b5090610f415f6107de565b91611018565b90565b610f5390610480565b90565b60207f722063616c6c0000000000000000000000000000000000000000000000000000917f416464726573733a20696e73756666696369656e742062616c616e636520666f5f8201520152565b610fb06026604092610dd1565b610fb981610f56565b0190565b610fd29060208101905f818303910152610fa3565b90565b15610fdc57565b610fe4610032565b7f08c379a00000000000000000000000000000000000000000000000000000000081528061101460048201610fbd565b0390fd5b915f809161106e9593611029610811565b5061105061103630610f4a565b3161104961104385610105565b91610105565b1015610fd5565b8591602082019151925af191611064610816565b909290919261110d565b90565b5f7f416464726573733a2063616c6c20746f206e6f6e2d636f6e7472616374000000910152565b6110a5601d602092610dd1565b6110ae81611071565b0190565b6110c79060208101905f818303910152611098565b90565b156110d157565b6110d9610032565b7f08c379a000000000000000000000000000000000000000000000000000000000815280611109600482016110b2565b0390fd5b919290611118610811565b505f1461115c5750611129826105b3565b61113b6111355f6107de565b91610105565b14611145575b5090565b61115161115691610f08565b6110ca565b5f611141565b826111af565b5190565b61118561118e6020936111939361117c81611162565b93848093610dd1565b958691016105c0565b61008c565b0190565b6111ac9160208201915f818403910152611166565b90565b906111b9826105b3565b6111cb6111c55f6107de565b91610105565b115f146111db5750805190602001fd5b611216906111e7610032565b9182917f08c379a000000000000000000000000000000000000000000000000000000000835260048301611197565b0390fd"

    public static let BridgeFeeTooHighError = ABI.Function(
        name: "BridgeFeeTooHigh",
        inputs: [.uint256, .uint256]
    )

    public enum RevertReason: Equatable, Error {
        case bridgeFeeTooHigh(BigUInt, BigUInt)
        case unknownRevert(String, String)
    }

    public static func rewrapError(_ error: ABI.Function, value: ABI.Value) -> RevertReason {
        switch (error, value) {
        case (BridgeFeeTooHighError, let .tuple2(.uint256(bridgeFee), .uint256(maxBridgeFee))):
            return .bridgeFeeTooHigh(bridgeFee, maxBridgeFee)
        case let (e, v):
            return .unknownRevert(e.name, String(describing: v))
        }
    }

    public static let errors: [ABI.Function] = [BridgeFeeTooHighError]
    public static let functions: [ABI.Function] = [depositV3Fn]
    public static let depositV3Fn = ABI.Function(
        name: "depositV3",
        inputs: [.address, .tuple([.address, .address, .address, .address, .uint256, .uint256, .uint256, .uint256, .address, .uint32, .uint32, .uint32, .bytes]), .bytes, .bool],
        outputs: []
    )

    public static func depositV3(spokePool: EthAddress, params: DepositV3Params, uniqueIdentifier: Hex, useNativeToken: Bool, withFunctions ffis: EVM.FFIMap = [:]) async throws -> Result<Void, RevertReason> {
        do {
            let query = try depositV3Fn.encoded(with: [.address(spokePool), params.asValue, .bytes(uniqueIdentifier), .bool(useNativeToken)])
            let result = try await EVM.runQuery(bytecode: runtimeCode, query: query, withErrors: errors, withFunctions: ffis)
            let decoded = try depositV3Fn.decode(output: result)

            switch decoded {
            case .tuple0:
                return .success(())
            default:
                throw ABI.DecodeError.mismatchedType(decoded.schema, depositV3Fn.outputTuple)
            }
        } catch let EVM.QueryError.error(e, v) {
            return .failure(rewrapError(e, value: v))
        }
    }

    public static func depositV3Decode(input: Hex) throws -> (EthAddress, DepositV3Params, Hex, Bool) {
        let decodedInput = try depositV3Fn.decodeInput(input: input)
        switch decodedInput {
        case let .tuple4(.address(spokePool), .tuple13(.address(depositor),
                                                       .address(recipient),
                                                       .address(inputToken),
                                                       .address(outputToken),
                                                       .uint256(inputAmount),
                                                       .uint256(outputAmount),
                                                       .uint256(maxFee),
                                                       .uint256(destinationChainId),
                                                       .address(exclusiveRelayer),
                                                       .uint32(quoteTimestamp),
                                                       .uint32(fillDeadline),
                                                       .uint32(exclusivityDeadline),
                                                       .bytes(message)), .bytes(uniqueIdentifier), .bool(useNativeToken)):
            return try (spokePool, DepositV3Params(depositor: depositor, recipient: recipient, inputToken: inputToken, outputToken: outputToken, inputAmount: inputAmount, outputAmount: outputAmount, maxFee: maxFee, destinationChainId: destinationChainId, exclusiveRelayer: exclusiveRelayer, quoteTimestamp: quoteTimestamp, fillDeadline: fillDeadline, exclusivityDeadline: exclusivityDeadline, message: message), uniqueIdentifier, useNativeToken)
        default:
            throw ABI.DecodeError.mismatchedType(decodedInput.schema, depositV3Fn.inputTuple)
        }
    }
}
